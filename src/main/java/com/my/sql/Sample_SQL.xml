<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="sample">
     
    <select id="selectBoardList" parameterType="hashmap" resultType="hashmap">
      
            SELECT bid, board_subject,member_id, board_hits, board_created FROM spoon_board
   WHERE BOARD_DELYN='N'
    </select>
     
     <insert id="insertBoard" parameterType="com.my.shop.BoardBean">
  
        INSERT INTO spoon_board
        (
            board_subject,
            board_contents,
            board_hits,
            subway_name,
            mid,
            member_id,
            board_address,
            board_lat,
            board_lng,
            board_shopname
            
          
        )
        VALUES
        (
            #{board_subject},
            #{board_contents},
            0,
            #{subway_name},
            #{mid},
            #{member_id},
            #{board_address},
            #{board_lat},
            #{board_lng},
            #{board_shopname}
           
        )
        
</insert>

<update id="updateHitCnt" parameterType="com.my.shop.BoardBean">
   
        UPDATE spoon_board
        SET
            board_hits = board_hits+ 1
        WHERE
            bid = #{bid}   
    
</update>
 
<select id="selectBoardDetail" parameterType="hashmap" resultType="hashmap">
    
        SELECT
            bid,
            board_hits,
            board_created,
            board_subject,
            board_contents,
            member_id,
            mid,
            subway_name,
            board_address,
            board_lat,
            board_lng
            
        FROM
            spoon_board
        WHERE
            bid = #{bid}       
    
</select>

<update id="updateBoard" parameterType="com.my.shop.BoardBean">
   
        UPDATE spoon_board
        SET
            board_subject = #{board_subject},
            board_contents = #{board_contents},
            board_created = now()
        WHERE
            bid = #{bid}   
    
</update>

<delete id="deleteBoard" parameterType="hashmap">
   
        UPDATE spoon_board
        SET
            BOARD_DELYN = 'Y'
        WHERE
            bid = #{bid}   
    
</delete>

<select id="selectSubway" parameterType="hashmap" resultType="hashmap">
	SELECT subway_name,subway_linenumber FROM SPOON_SUBWAY 
	WHERE SUBWAY_LINENUMBER = #{subway_linenumber}
	ORDER BY SUBWAY_NAME ASC
</select>





<select id="selectComment" parameterType="com.my.shop.CommentBean" resultType="com.my.shop.CommentBean">
      
            SELECT member_id, comment_created, comment  FROM board_comment
   WHERE BOARD_DELYN='N' and bid=#{bid}
</select>

<insert id="insertComment" parameterType="com.my.shop.CommentBean">
  
        INSERT INTO board_comment
        (
            bid,
            comments,
            member_id,
            mid
        )
        VALUES
        (
            #{bid},
            #{comments},
            #{member_id},
            #{mid}
        )
</insert>

<insert id="uploadFile" parameterType="com.my.shop.uploadFileVo">
INSERT INTO BOARD_UPLOAD
 (BID, FILE_NUM, O_NAME, FILE_NAME) 
 VALUES 
 (#{bid}, #{file_num}, #{o_name}, #{file_name})
</insert>

<select id="selectBID" resultType="int">
	SELECT ifnull (max(bid), 0 ) FROM SPOON_BOARD
</select>

<select id="selectImage" parameterType="com.my.shop.uploadFileVo" resultType="hashmap">
	SELECT FILE_NAME FROM BOARD_UPLOAD WHERE BID = #{bid}
</select>

</mapper>